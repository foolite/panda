<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
	"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
	<bean type="com.opensymphony.xwork2.UnknownHandler" name="handler" class="panda.exts.struts2.ServletUnknownHandler"/>

	<bean type="org.apache.struts2.components.template.TemplateEngine" name="java" class="panda.exts.struts2.views.java.JavaTemplateEngine"/>
	<constant name="struts.templateEngines" value="ftl,jsp,vm,java" />

	<bean type="org.apache.struts2.views.TagLibraryDirectiveProvider" name="p" class="panda.exts.struts2.views.PandaTagLibrary" />
	<bean type="org.apache.struts2.views.TagLibraryModelProvider" name="p" class="panda.exts.struts2.views.PandaTagLibrary" />

	<bean type="org.apache.struts2.dispatcher.mapper.ActionMapper" name="panda" class="panda.exts.struts2.dispatcher.mapper.PandaActionMapper"/>
	<constant name="struts.mapper.class" value="panda"/>

	<bean class="panda.exts.struts2.sitemesh.FreeMarkerPageFilter" static="true" optional="true"/>
	<bean type="org.apache.struts2.views.freemarker.FreemarkerManager" name="panda" class="panda.exts.struts2.views.freemarker.FreemarkerManager"/>
	<constant name="struts.freemarker.manager.classname" value="panda"/>

	<bean class="panda.exts.fileupload.UploadManager" static="true" optional="true"/>
	<bean type="panda.exts.struts2.dispatcher.multipart.MultiPartRequest" class="panda.exts.struts2.dispatcher.multipart.VfsMultiPartRequest" scope="default"/>
	
	<bean type="panda.dao.DaoClientHolder" class="panda.dao.DaoClientHolder"/>

	<package name="panda-default" abstract="true" extends="struts-default">
		<result-types>
			<result-type name="empty" class="panda.exts.struts2.dispatcher.EmptyResult"/>
			<result-type name="json" class="panda.exts.struts2.dispatcher.JsonResult"/>
			<result-type name="xml" class="panda.exts.struts2.dispatcher.XmlResult"/>
			<result-type name="error" class="panda.exts.struts2.dispatcher.SendErrorResult"/>
			<result-type name="exception" class="panda.exts.struts2.dispatcher.ExceptionResult"/>
		</result-types>

		<interceptors>
			<interceptor name="actionHelper" class="panda.exts.struts2.interceptor.ActionHelperInterceptor"/>
			<interceptor name="daoClient" class="panda.exts.xwork2.interceptor.DaoClientInterceptor"/>
			<interceptor name="vfsFileUpload" class="panda.exts.struts2.interceptor.FileUploadInterceptor"/>
			<interceptor name="layout" class="panda.exts.struts2.interceptor.LayoutInterceptor"/>
			<interceptor name="locale" class="panda.exts.struts2.interceptor.LocaleInterceptor"/>
			<interceptor name="unknownMethod" class="panda.exts.struts2.interceptor.UnknownMethodInterceptor"/>

			<interceptor-stack name="pandaPrepStack">
				<interceptor-ref name="exception"/>
				<interceptor-ref name="alias"/>
				<interceptor-ref name="unknownMethod"/>
				<interceptor-ref name="servletConfig"/>
				<interceptor-ref name="actionHelper"/>
				<interceptor-ref name="daoClient"/>
				<interceptor-ref name="locale"/>
				<interceptor-ref name="layout"/>
			</interceptor-stack>

			<interceptor-stack name="pandaWorkStack">
				<interceptor-ref name="prepare"/>
				<interceptor-ref name="chain"/>
				<interceptor-ref name="debugging"/>
				<interceptor-ref name="profiling"/>
				<interceptor-ref name="scopedModelDriven"/>
				<interceptor-ref name="modelDriven"/>
				<interceptor-ref name="vfsFileUpload"/>
				<interceptor-ref name="checkbox"/>
				<interceptor-ref name="multiselect"/>
				<interceptor-ref name="staticParams"/>
				<interceptor-ref name="actionMappingParams"/>
				<interceptor-ref name="params">
					<param name="excludeParams">dojo\..*,^struts\..*</param>
				</interceptor-ref>
				<interceptor-ref name="conversionError"/>
				<interceptor-ref name="validation">
					<param name="excludeMethods">input,back,cancel,browse</param>
				</interceptor-ref>
				<interceptor-ref name="workflow">
					<param name="excludeMethods">input,back,cancel,browse</param>
				</interceptor-ref>
			</interceptor-stack>

			<interceptor-stack name="pandaStack">
				<interceptor-ref name="pandaPrepStack"/>
				<interceptor-ref name="pandaWorkStack"/>
			</interceptor-stack>
		</interceptors>

		<default-interceptor-ref name="pandaStack"/>

		<default-class-ref class="panda.exts.xwork2.ActionSupport"/>
	</package>
</struts>
